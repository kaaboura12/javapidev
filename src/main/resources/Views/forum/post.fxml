<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.*?>
<?import java.util.*?>
<?import javafx.scene.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.text.*?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.effect.*?>
<?import javafx.scene.shape.Rectangle?>
<?import javafx.scene.shape.Circle?>

<StackPane fx:id="rootPane" xmlns="http://javafx.com/javafx"
          xmlns:fx="http://javafx.com/fxml"
          fx:controller="Controllers.forum.PostController" 
          stylesheets="@../../Styles/post.css">
          
    <ScrollPane fitToWidth="true" fitToHeight="true" styleClass="forum-scroll-pane">
        <VBox spacing="30" styleClass="forum-container">
            <padding>
                <Insets top="30" right="30" bottom="30" left="30"/>
            </padding>
            
            <!-- Page Header with Title -->
            <HBox styleClass="page-header-container" alignment="CENTER">
                <VBox HBox.hgrow="ALWAYS">
                    <!-- Page Title -->
                    <HBox alignment="CENTER_LEFT" styleClass="page-title-container">
                        <Label text="Community Forum" styleClass="page-title-modern">
                            <effect>
                                <DropShadow color="#00000066" blurType="GAUSSIAN" radius="15.0" spread="0.2" offsetY="4"/>
                            </effect>
                        </Label>
                    </HBox>
                    
                    <!-- Page Description -->
                    <Label text="Share ideas and connect with other artists" 
                           styleClass="page-description-modern"/>
                </VBox>
                
               
            </HBox>
            
            <!-- New Post Form -->
            <VBox styleClass="new-post-container" spacing="15">
                <Label text="Create New Post" styleClass="section-title-modern"/>
                
                <TextField fx:id="titleField" promptText="Title" styleClass="post-input"/>
                <TextArea fx:id="contentField" promptText="Share your thoughts..." prefRowCount="4" styleClass="post-text-area"/>
                
                <HBox spacing="10" alignment="CENTER_RIGHT">
                    <TextField fx:id="imageField" promptText="Image URL" HBox.hgrow="ALWAYS" styleClass="post-input" visible="false" managed="false"/>
                    <StackPane fx:id="imagePreviewContainer" styleClass="image-preview-container" managed="false" visible="false">
                        <ImageView fx:id="imagePreview" fitWidth="150" preserveRatio="true" styleClass="image-preview"/>
                        <Button fx:id="clearImageButton" text="âœ•" styleClass="clear-image-button" onAction="#handleClearImage" 
                                StackPane.alignment="TOP_RIGHT"/>
                    </StackPane>
                    <Button text="Image URL" onAction="#handleSelectImage" styleClass="secondary-button"/>
                    <Button fx:id="generateImageButton" text="Generate" onAction="#handleGenerateImage" styleClass="generate-button"/>
                </HBox>

                <HBox spacing="10" alignment="CENTER_RIGHT">
                    <Button text="Clear" onAction="#clearFields" styleClass="cancel-button"/>
                    <Button fx:id="addButton" text="Add New Post" onAction="#handleAddPost" styleClass="primary-button"/>
                </HBox>
            </VBox>
            
            
            <!-- Posts Container -->
            <VBox fx:id="postsContainer" spacing="20" styleClass="posts-list-modern"/>
            
            <!-- Hidden TableView for Data Operations -->
            <VBox visible="false" managed="false">
                <TableView fx:id="postsTable">
                    <columns>
                        <TableColumn fx:id="idColumn" text="ID"/>
                        <TableColumn fx:id="titleColumn" text="Title"/>
                        <TableColumn fx:id="contentColumn" text="Content"/>
                        <TableColumn fx:id="imageColumn" text="Image"/>
                        <TableColumn fx:id="dateColumn" text="Date"/>
                    </columns>
                </TableView>
            </VBox>
        </VBox>
    </ScrollPane>
    
    <!-- Template for post card (will be used in the controller) -->
    <fx:define>
        <VBox fx:id="postCardTemplate" styleClass="post-card-modern" visible="false">
            <!-- Post Header -->
            <HBox styleClass="post-header" spacing="10" alignment="CENTER_LEFT">
                <Circle radius="20" styleClass="user-avatar"/>
                <VBox spacing="2">
                    <Label fx:id="postAuthor" text="Username" styleClass="post-author"/>
                    <Label fx:id="postDate" text="01/01/2023 12:34" styleClass="post-date"/>
                </VBox>
                
                <Region HBox.hgrow="ALWAYS"/>
                
                <HBox spacing="8" alignment="CENTER_RIGHT" styleClass="post-actions">
                    <Button styleClass="edit-button, icon-button">
                        <tooltip>
                            <Tooltip text="Edit"/>
                        </tooltip>
                    </Button>
                    <Button styleClass="delete-button, icon-button">
                        <tooltip>
                            <Tooltip text="Delete"/>
                        </tooltip>
                    </Button>
                </HBox>
            </HBox>
            
            <!-- Post Content -->
            <VBox styleClass="post-content" spacing="8">
                <Label fx:id="postTitle" text="Post Title" styleClass="post-title-modern" wrapText="true"/>
                <Label fx:id="postContent" text="Post content goes here..." styleClass="post-content-text" wrapText="true"/>
                
                <!-- Post Image if available -->
                <StackPane fx:id="postImageContainer" styleClass="post-image-container">
                    <ImageView fx:id="postImage" fitWidth="400" preserveRatio="true" styleClass="post-image-modern"/>
                </StackPane>
            </VBox>
            
            <!-- Comments Section -->
            <VBox styleClass="comments-section" spacing="8">
                <HBox alignment="CENTER_LEFT" styleClass="section-subtitle-container">
                    <Label text="Comments" styleClass="section-subtitle"/>
                </HBox>
                
                <!-- Comment list will be populated here -->
                <VBox fx:id="commentsBox" styleClass="comments-box" spacing="8"/>
                
                <!-- New comment form -->
                <HBox spacing="8" styleClass="new-comment-container">
                    <TextArea fx:id="newCommentField" promptText="Add a comment..." prefRowCount="1" 
                             styleClass="comment-text-area" HBox.hgrow="ALWAYS"/>
                    <Button fx:id="gifButton" text="GIF" onAction="#handleShowGifPicker" 
                           styleClass="gif-button"/>
                    <Button fx:id="addCommentButton" text="Comment" onAction="#handleAddComment" 
                           styleClass="comment-button"/>
                </HBox>
            </VBox>
        </VBox>
    </fx:define>
</StackPane>
